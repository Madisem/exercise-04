---
title: "Wordle"
author: "Madina"
format: html
editor: visual
---

I will try to make wordle game! WOW excited! Can't wait when it will be done! \## Running Code

```{r}
library(tidyverse)
load_dictionary<-function(filename)
{
  x<-read_csv(filename)
  return (x)
}
valid_list <- load_dictionary("collins-scrabble-words-2019.txt")
solution_list <- load_dictionary("google-10000-english-usa-no-swears.txt")

str(valid_list)
str(solution_list)


#Step 2

solution_list<-intersect(solution_list, valid_list)
```

You can add options to executable code like this

```{r}
library(dplyr)

pick_solution<-function(table, n){ 
  filtered_df <- subset(table, nchar(words) == n)
  w<-sample(filtered_df[[1]], size = 1, replace = FALSE)
  word_array<-unlist(strsplit(w, split = ""))
  return(word_array)
}

 
a<-pick_solution(solution_list,5)
a
```

```{r}
evalutate_guess<-function(guess, solution){
  found=0
  letter_match=0
  position_match=0
  for (i in 1:length(guess)){
    for (j in 1:length(solution)){
       if (i==j & guess[i] == solution[j]){
        print(paste("You letter",guess[i],"is in the right position in the word"))
        position_match=position_match+1
        found = found + 1
        }
      else if (guess[i] == solution[j]){
        print(paste("You letter",guess[i],"is in the word but not in the right position"))
        letter_match=letter_match+1
        found = found + 1
      }
      else { next}
    }
  }
  print(paste("You have guessed ",letter_match+position_match," letters of the word!"))
  if (length(setdiff(guess, sollution)) == 0){
    output = 1
  }
  else {output = 0}
  return(output)
  
} 
  
  
check_guess<-function(guess,solution,valid_list){
Flag="No"
guess_word <- paste(guess, collapse = "")
if (is.null(guess))  {
  print("Empty word! Enter the word!")
  Flag="No"
  } else if (length(guess) != length(solution)) {
    print("Enter only the same length words as hidden behind")
    Flag="No"
  }
  else if (!(guess_word %in% valid_list)){
    print("Enter the valid words only!")
    Flag="No"
  }
  else {
      Flag="Yes"}
return(Flag)
}

play_wordle <- function(solution, valid_list, num_guesses=6){
  print("Welcome to the Wordle game by Madina")
  print("You have 6 chances to predict the word hidden behind the blocks")
  print("When you guess right the letter will be present")
  Flag="No"
  if (Flag == "No") {
  enter <- toupper(readline("Type your word, then press <enter>: "))
  guess<-unlist(strsplit(enter, split = ""))
  check_guess(guess,solution,valid_list)
  }
  if (Flag=="Yes"){
    evalutate_guess(guess,solution)
  }
}
play_wordle(a,valid_list,6)

###test
enter <- toupper(readline("Type your word, then press <enter>: "))
guess<-unlist(strsplit(enter, split = ""))
for (i in guess){
  print(guess[i])
}
a
setdiff(guess,a)

```

```{r}
df <- data.frame(
  x = 1:length(a),
  y = 1,
  letters = rep("",length(a))
)

# Plot boxes with letters
ggplot(df, aes(x = x, y = y, label = letters)) +
  geom_tile(fill = "white", color = "black", size = 2) +  # Boxes
  geom_text(size = 8) +  # Letters
  theme_void() +  # Remove background
  coord_fixed()


```

The `echo: false` option disables the printing of code (only output is displayed).
