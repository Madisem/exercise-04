---
title: "Wordle"
author: "Madina"
format: html
editor: visual
---

I will try to make wordle game! WOW excited! Can't wait when it will be done!
## Running Code

 

```{r}
library(tidyverse)
load_dictionary<-function(filename)
{
  x<-read_csv(filename)
  return (x)
}
valid_list <- load_dictionary("collins-scrabble-words-2019.txt")
solution_list <- load_dictionary("google-10000-english-usa-no-swears.txt")

str(valid_list)
str(solution_list)


#Step 2

solution_list<-intersect(solution_list, valid_list)
```

You can add options to executable code like this

```{r}
library(dplyr)

pick_solution<-function(table, n){ 
  filtered_df <- subset(table, nchar(words) == n)
  w<-sample(filtered_df[[1]], size = 1, replace = FALSE)
  word_array<-unlist(strsplit(w, split = ""))
  return(word_array)
}

 
a<-pick_solution(solution_list,5)
a

evalutate_guess<-function(guess, solution){
  found=0
  for (i in guess){
    for (j in solution){
      if (i==j & guess[i] == solution[j]){
        print("You letter",guess[i],"is in the right position in the word")
        found = found + 1
        }
      else if (guess[i] == solution[j]){
        print("You letter",guess[i],"is in the word but in the right position")
        found = found + 1
      }
      else { print("You guessed ", found, " letters of the word! Keep going")}
        
      }
    }
} 

play_wordle <- function(solution, valid_list, num_guesses=6){
  print("Welcome to the Wordle game by Madina")
  print("You have 6 chances to predict the word hidden behind the blocks")
  print("When you guess right the letter will be present")
  guess <- readline("Type your word, then press <enter>: ") |> toupper()
  if (guess == "") {
  print("Please enter the word:")
  guess <- readline("Type your word, then press <enter>: ") |> toupper()
  }
  else if (length(guess) != length(solution)) {
    print("Enter only 5 letter words")
    guess <- readline("Type your word, then press <enter>: ") |> toupper()

  }
  else { evalutate_guess(guess,solution) }
}
play_wordle(a,valid_list,6)

Flag="No"

check_guess<-function(guess){
if (guess == "") {
  print("Empty word! Enter the word!")
  Flag="No"
  } else if (length(guess) != length(a)) {
    print("Enter only the same length words as hidden behind")
    Flag="No"
  } else { evalutate_guess(guess,solution)
      Flag="Yes"}
}

if (Flag == "No") {
  guess <- toupper(readline("Type your word, then press <enter>: "))
  check_guess(guess)
}
Flag="Yes"
#guess <- readline("Type your word, then press <enter>: ") |> toupper()



df <- data.frame(
  x = 1:length(a),
  y = 1,
  letters = rep("",length(a))
)

# Plot boxes with letters
ggplot(df, aes(x = x, y = y, label = letters)) +
  geom_tile(fill = "white", color = "black", size = 2) +  # Boxes
  geom_text(size = 8) +  # Letters
  theme_void() +  # Remove background
  coord_fixed()


```

The `echo: false` option disables the printing of code (only output is displayed).
